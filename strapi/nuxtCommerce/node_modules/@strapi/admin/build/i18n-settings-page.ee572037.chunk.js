"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[3552],{98225:(nt,B,s)=>{s.r(B),s.d(B,{default:()=>at});var e=s(32735),f=s(88425),de=s(60216),v=s.n(de),y=s(5636),L=s(41415),re=s(27649),ue=s(39161),me=s(28356),ve=s(17e3),I=s(19406),fe=s(54725),Z=s(74552),r=s(90431),C=s(83281),z=s(66456),V=s(85025),j=s(55225),G=s(31600),U=s(11406),H=s(35540),S=s(39291),O=s(3653),W=s(36320),X=s(62345),$=s(9026),h=s(88860),T=s(5173);const K=(0,T.Ry)().shape({code:(0,T.Z_)().required(),displayName:(0,T.Z_)().max(50,"Settings.locales.modal.locales.displayName.error").required(f.translatedErrors.required)});var P=s(4409),A=s(9494),Q=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const ge=(a,l,t)=>Q(void 0,null,function*(){try{const n=yield(0,f.request)(`/i18n/locales/${a}`,{method:"PUT",body:l});return t({type:"success",message:{id:(0,r.O)("Settings.locales.modal.edit.success")}}),n}catch(n){return t({type:"warning",message:{id:"notification.error"}}),null}}),ye=()=>{const[a,l]=(0,e.useState)(!1),t=(0,P.useDispatch)(),n=(0,f.useNotification)();return{isEditing:a,editLocale:(d,u)=>Q(void 0,null,function*(){l(!0);const c=yield ge(d,u,n);t({type:A.OT,editedLocale:c}),l(!1)})}};var J=s(15335),M=s(5803),Y=s(10369),he=s(70218),pe=s(84967),Ee=s(84968),Le=s(94638),Ce=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const Se=a=>Ce(void 0,null,function*(){try{return yield(0,f.request)("/i18n/iso-locales",{method:"GET"})}catch(l){return a({type:"warning",message:{id:"notification.error"}}),[]}}),w=()=>{const{formatMessage:a}=(0,y.useIntl)(),{notifyStatus:l}=(0,Le.G)(),t=(0,f.useNotification)(),{isLoading:n,data:i}=(0,Ee.useQuery)("default-locales",()=>Se(t).then(d=>(l(a({id:(0,r.O)("Settings.locales.modal.locales.loaded"),defaultMessage:"The locales have been successfully loaded."})),d)));return{defaultLocales:i,isLoading:n}},q=({locale:a})=>{const{formatMessage:l}=(0,y.useIntl)(),{values:t,handleChange:n,errors:i}=(0,C.useFormikContext)(),{defaultLocales:d,isLoading:u}=w(),c=!u&&d.find(o=>o.code===a.code);return e.createElement(J.r,{gap:4},e.createElement(M.P,{col:6},e.createElement(he.P,{label:l({id:(0,r.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:(c==null?void 0:c.code)||a.code,disabled:!0},e.createElement(pe.W,{value:(c==null?void 0:c.code)||a.code},(c==null?void 0:c.name)||a.code))),e.createElement(M.P,{col:6},e.createElement(Y.o,{name:"displayName",label:l({id:(0,r.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:l({id:(0,r.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?l({id:(0,r.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:t.displayName,onChange:n})))},Oe=q;q.propTypes={locale:v().shape({id:v().number.isRequired,name:v().string.isRequired,code:v().string.isRequired,isDefault:v().bool.isRequired}).isRequired};var k=s(8284);const _=({isDefaultLocale:a})=>{const{values:l,setFieldValue:t}=(0,C.useFormikContext)(),{formatMessage:n}=(0,y.useIntl)();return e.createElement(k.X,{name:"isDefault",hint:n({id:(0,r.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>t("isDefault",!l.isDefault),value:l.isDefault,disabled:a},n({id:(0,r.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};_.propTypes={isDefaultLocale:v().bool.isRequired};const De=_;var Me=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const x=({locale:a,onClose:l})=>{const{refetchPermissions:t}=(0,f.useRBACProvider)(),{isEditing:n,editLocale:i}=ye(),{formatMessage:d}=(0,y.useIntl)(),u=c=>Me(void 0,[c],function*({displayName:o,isDefault:m}){yield i(a.id,{name:o,isDefault:m}),yield t()});return e.createElement(V.P,{onClose:l,labelledBy:"edit-locale-title"},e.createElement(C.Formik,{initialValues:{code:a==null?void 0:a.code,displayName:(a==null?void 0:a.name)||"",isDefault:Boolean(a==null?void 0:a.isDefault)},onSubmit:u,validationSchema:K},e.createElement(f.Form,null,e.createElement(j.x,null,e.createElement(h.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"edit-locale-title"},d({id:(0,r.O)("Settings.list.actions.edit"),defaultMessage:"Edit a locale"}))),e.createElement(G.f,null,e.createElement(H.v,{label:d({id:(0,r.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(W.k,{justifyContent:"space-between"},e.createElement(h.Z,{as:"h2"},d({id:(0,r.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(S.m,null,e.createElement(S.O,null,d({id:(0,r.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(S.O,null,d({id:(0,r.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement($.i,null),e.createElement(X.x,{paddingTop:7,paddingBottom:7},e.createElement(O.n,null,e.createElement(O.x,null,e.createElement(Oe,{locale:a})),e.createElement(O.x,null,e.createElement(De,{isDefaultLocale:Boolean(a&&a.isDefault)})))))),e.createElement(U.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:l},d({id:"app.components.Button.cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(z.Z,null),disabled:n},d({id:"global.save"}))}))))};x.defaultProps={locale:void 0},x.propTypes={locale:v().shape({id:v().number.isRequired,name:v().string.isRequired,code:v().string.isRequired,isDefault:v().bool.isRequired}),onClose:v().func.isRequired};const Te=x;var ee=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const Pe=(a,l)=>ee(void 0,null,function*(){try{const t=yield(0,f.request)(`/i18n/locales/${a}`,{method:"DELETE"});return l({type:"success",message:{id:(0,r.O)("Settings.locales.modal.delete.success")}}),t}catch(t){return l({type:"warning",message:{id:"notification.error"}}),t}}),Ae=()=>{const[a,l]=(0,e.useState)(!1),t=(0,P.useDispatch)(),n=(0,f.useNotification)();return{isDeleting:a,deleteLocale:d=>ee(void 0,null,function*(){l(!0),yield Pe(d,n),t({type:A.HC,id:d}),l(!1)})}},F=({localeToDelete:a,onClose:l})=>{const{isDeleting:t,deleteLocale:n}=Ae(),i=Boolean(a),d=()=>n(a.id).then(l);return e.createElement(f.ConfirmDialog,{isConfirmButtonLoading:t,onConfirm:d,onToggleDialog:l,isOpen:i})};F.defaultProps={localeToDelete:void 0},F.propTypes={localeToDelete:v().shape({id:v().number.isRequired}),onClose:v().func.isRequired};const xe=F;var Fe=s(33795),Ne=s.n(Fe),te=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const Re=(a,l)=>te(void 0,[a,l],function*({code:t,name:n,isDefault:i},d){const u=yield(0,f.request)("/i18n/locales",{method:"POST",body:{name:n,code:t,isDefault:i}});return d({type:"success",message:{id:(0,r.O)("Settings.locales.modal.create.success")}}),u}),be=()=>{const[a,l]=(0,e.useState)(!1),t=(0,P.useDispatch)(),n=(0,f.useNotification)();return{isAdding:a,addLocale:d=>te(void 0,null,function*(){l(!0);try{const u=yield Re(d,n);t({type:A.xz,newLocale:u})}catch(u){const c=Ne()(u,"response.payload.message",null);throw c&&c.includes("already exists")?n({type:"warning",message:{id:(0,r.O)("Settings.locales.modal.create.alreadyExist")}}):n({type:"warning",message:{id:"notification.error"}}),u}finally{l(!1)}})}};var Be=s(21590),Ie=s(90333);const N=e.memo(({value:a,onClear:l,onLocaleChange:t,error:n})=>{const{formatMessage:i}=(0,y.useIntl)(),{defaultLocales:d,isLoading:u}=w(),{locales:c}=(0,Z.Z)(),o=(d||[]).map(g=>({label:g.name,value:g.code})).filter(({value:g})=>{const E=c.find(({code:D})=>D===g);return!E||E.code===a}),m=a||"";return e.createElement(Be.h,{"aria-busy":u,error:n,label:i({id:(0,r.O)("Settings.locales.modal.locales.label"),defaultMessage:"Locales"}),value:m,onClear:a?l:void 0,onChange:g=>{const E=o.find(D=>D.value===g);E&&t({code:E.value,displayName:E.label})},placeholder:i({id:"components.placeholder.select",defaultMessage:"Select"})},o.map(g=>e.createElement(Ie.O,{value:g.value,key:g.value},g.label)))});N.defaultProps={error:void 0,value:void 0,onClear(){},onLocaleChange:()=>{}},N.propTypes={error:v().string,onClear:v().func,onLocaleChange:v().func,value:v().string};const Ze=N,ze=()=>{const{formatMessage:a}=(0,y.useIntl)(),{values:l,handleChange:t,setFieldValue:n,errors:i}=(0,C.useFormikContext)(),d=(0,e.useCallback)(c=>{n("displayName",c.displayName),n("code",c.code)},[n]),u=(0,e.useCallback)(()=>{n("displayName",""),n("code","")},[n]);return e.createElement(J.r,{gap:4},e.createElement(M.P,{col:6},e.createElement(Ze,{error:i.code,value:l.code,onLocaleChange:d,onClear:u})),e.createElement(M.P,{col:6},e.createElement(Y.o,{name:"displayName",label:a({id:(0,r.O)("Settings.locales.modal.locales.displayName"),defaultMessage:"Locale display name"}),hint:a({id:(0,r.O)("Settings.locales.modal.locales.displayName.description"),defaultMessage:"Locale will be displayed under that name in the administration panel"}),error:i.displayName?a({id:(0,r.O)("Settings.locales.modal.locales.displayName.error"),defaultMessage:"The locale display name can only be less than 50 characters."}):void 0,value:l.displayName,onChange:t})))},Ve=()=>{const{values:a,setFieldValue:l}=(0,C.useFormikContext)(),{formatMessage:t}=(0,y.useIntl)();return e.createElement(k.X,{hint:t({id:(0,r.O)("Settings.locales.modal.advanced.setAsDefault.hint"),defaultMessage:"One default locale is required, change it by selecting another one"}),onChange:()=>l("isDefault",!a.isDefault),value:a.isDefault},t({id:(0,r.O)("Settings.locales.modal.advanced.setAsDefault"),defaultMessage:"Set as default locale"}))};var je=(a,l,t)=>new Promise((n,i)=>{var d=o=>{try{c(t.next(o))}catch(m){i(m)}},u=o=>{try{c(t.throw(o))}catch(m){i(m)}},c=o=>o.done?n(o.value):Promise.resolve(o.value).then(d,u);c((t=t.apply(a,l)).next())});const Ge={code:"",displayName:"",isDefault:!1},ae=({onClose:a})=>{const{isAdding:l,addLocale:t}=be(),{formatMessage:n}=(0,y.useIntl)(),{refetchPermissions:i}=(0,f.useRBACProvider)(),d=u=>je(void 0,null,function*(){yield t({code:u.code,name:u.displayName,isDefault:u.isDefault}),yield i()});return e.createElement(V.P,{onClose:a,labelledBy:"add-locale-title"},e.createElement(C.Formik,{initialValues:Ge,onSubmit:d,validationSchema:K,validateOnChange:!1},e.createElement(f.Form,null,e.createElement(j.x,null,e.createElement(h.Z,{fontWeight:"bold",textColor:"neutral800",as:"h2",id:"add-locale-title"},n({id:(0,r.O)("Settings.list.actions.add"),defaultMessage:"Add new locale"}))),e.createElement(G.f,null,e.createElement(H.v,{label:n({id:(0,r.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"}),id:"tabs",variant:"simple"},e.createElement(W.k,{justifyContent:"space-between"},e.createElement(h.Z,{as:"h2",variant:"beta"},n({id:(0,r.O)("Settings.locales.modal.title"),defaultMessage:"Configurations"})),e.createElement(S.m,null,e.createElement(S.O,null,n({id:(0,r.O)("Settings.locales.modal.base"),defaultMessage:"Basic settings"})),e.createElement(S.O,null,n({id:(0,r.O)("Settings.locales.modal.advanced"),defaultMessage:"Advanced settings"})))),e.createElement($.i,null),e.createElement(X.x,{paddingTop:7,paddingBottom:7},e.createElement(O.n,null,e.createElement(O.x,null,e.createElement(ze,null)),e.createElement(O.x,null,e.createElement(Ve,null)))))),e.createElement(U.m,{startActions:e.createElement(L.z,{variant:"tertiary",onClick:a},n({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(L.z,{type:"submit",startIcon:e.createElement(z.Z,null),disabled:l},n({id:"global.save",defaultMessage:"Save"}))}))))};ae.propTypes={onClose:v().func.isRequired};const Ue=ae;var le=s(50563),He=s(27677),We=s(3685),Xe=s(94745),$e=s(76330),ne=s(29005),p=s(66735),Ke=s(3594),Qe=s(68625),Je=s(4038),Ye=Object.defineProperty,oe=Object.getOwnPropertySymbols,we=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable,se=(a,l,t)=>l in a?Ye(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,ie=(a,l)=>{for(var t in l||(l={}))we.call(l,t)&&se(a,t,l[t]);if(oe)for(var t of oe(l))qe.call(l,t)&&se(a,t,l[t]);return a};const R=({locales:a,onDeleteLocale:l,onEditLocale:t})=>{const{formatMessage:n}=(0,y.useIntl)();return e.createElement(Xe.i,{colCount:4,rowCount:a.length+1},e.createElement($e.h,null,e.createElement(ne.Tr,null,e.createElement(p.Th,null,e.createElement(h.Z,{variant:"sigma",textColor:"neutral600"},n({id:(0,r.O)("Settings.locales.row.id")}))),e.createElement(p.Th,null,e.createElement(h.Z,{variant:"sigma",textColor:"neutral600"},n({id:(0,r.O)("Settings.locales.row.displayName")}))),e.createElement(p.Th,null,e.createElement(h.Z,{variant:"sigma",textColor:"neutral600"},n({id:(0,r.O)("Settings.locales.row.default-locale")}))),e.createElement(p.Th,null,e.createElement(We.T,null,"Actions")))),e.createElement(Ke.p,null,a.map(i=>e.createElement(ne.Tr,ie({key:i.id},(0,f.onRowClick)({fn:()=>t(i),condition:t})),e.createElement(p.Td,null,e.createElement(h.Z,{textColor:"neutral800"},i.id)),e.createElement(p.Td,null,e.createElement(h.Z,{textColor:"neutral800"},i.name)),e.createElement(p.Td,null,e.createElement(h.Z,{textColor:"neutral800"},i.isDefault?n({id:(0,r.O)("Settings.locales.default")}):null)),e.createElement(p.Td,null,e.createElement(He.K,ie({horizontal:!0,spacing:1,style:{justifyContent:"flex-end"}},f.stopPropagation),t&&e.createElement(le.h,{onClick:()=>t(i),label:n({id:(0,r.O)("Settings.list.actions.edit")}),icon:e.createElement(Qe.Z,null),noBorder:!0}),l&&!i.isDefault&&e.createElement(le.h,{onClick:()=>l(i),label:n({id:(0,r.O)("Settings.list.actions.delete")}),icon:e.createElement(Je.default,null),noBorder:!0})))))))};R.defaultProps={locales:[],onDeleteLocale:void 0,onEditLocale:void 0},R.propTypes={locales:v().array,onDeleteLocale:v().func,onEditLocale:v().func};const ke=R,b=({canUpdateLocale:a,canDeleteLocale:l,onToggleCreateModal:t,isCreating:n})=>{const[i,d]=(0,e.useState)(),[u,c]=(0,e.useState)(),{locales:o}=(0,Z.Z)(),{formatMessage:m}=(0,y.useIntl)();(0,f.useFocusWhenNavigate)();const g=()=>d(void 0),E=l?d:void 0,D=()=>c(void 0),lt=a?c:void 0;return e.createElement(re.o,{tabIndex:-1},e.createElement(me.T,{primaryAction:e.createElement(L.z,{startIcon:e.createElement(I.default,null),onClick:t,size:"S"},m({id:(0,r.O)("Settings.list.actions.add")})),title:m({id:(0,r.O)("plugin.name")}),subtitle:m({id:(0,r.O)("Settings.list.description")})}),e.createElement(ve.D,null,(o==null?void 0:o.length)>0?e.createElement(ke,{locales:o,onDeleteLocale:E,onEditLocale:lt}):e.createElement(ue.EmptyStateLayout,{icon:e.createElement(fe.default,{width:void 0,height:void 0}),content:m({id:(0,r.O)("Settings.list.empty.title")}),action:t?e.createElement(L.z,{variant:"secondary",startIcon:e.createElement(I.default,null),onClick:t},m({id:(0,r.O)("Settings.list.actions.add")})):null})),n&&e.createElement(Ue,{onClose:t}),u&&e.createElement(Te,{onClose:D,locale:u}),e.createElement(xe,{localeToDelete:i,onClose:g}))};b.defaultProps={onToggleCreateModal:void 0},b.propTypes={canUpdateLocale:v().bool.isRequired,canDeleteLocale:v().bool.isRequired,onToggleCreateModal:v().func,isCreating:v().bool.isRequired};const _e=b,ce=({canReadLocale:a,canCreateLocale:l,canDeleteLocale:t,canUpdateLocale:n})=>{const[i,d]=(0,e.useState)(!1),u=l?()=>d(c=>!c):void 0;return a?e.createElement(_e,{canUpdateLocale:n,canDeleteLocale:t,onToggleCreateModal:u,isCreating:i}):null};ce.propTypes={canReadLocale:v().bool.isRequired,canCreateLocale:v().bool.isRequired,canUpdateLocale:v().bool.isRequired,canDeleteLocale:v().bool.isRequired};const et=ce;var tt=s(58347);const at=()=>{const{isLoading:a,allowedActions:{canRead:l,canUpdate:t,canCreate:n,canDelete:i}}=(0,f.useRBAC)(tt.Z);return a?null:e.createElement(et,{canReadLocale:l,canCreateLocale:n,canUpdateLocale:t,canDeleteLocale:i})}}}]);
