"use strict";var _=Object.defineProperty,j=Object.defineProperties;var L=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var v=(e,s,a)=>s in e?_(e,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[s]=a,x=(e,s)=>{for(var a in s||(s={}))w.call(s,a)&&v(e,a,s[a]);if(y)for(var a of y(s))F.call(s,a)&&v(e,a,s[a]);return e},R=(e,s)=>j(e,L(s));var I=(e,s)=>{var a={};for(var r in e)w.call(e,r)&&s.indexOf(r)<0&&(a[r]=e[r]);if(e!=null&&y)for(var r of y(e))s.indexOf(r)<0&&F.call(e,r)&&(a[r]=e[r]);return a};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const b=require("react"),O=require("prop-types"),C=require("../Box/Box.cjs"),c=require("../helpers/getFocusableNodes.cjs"),g=require("../helpers/keyboardKeys.cjs"),D=require("./RawTableContext.cjs"),B=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},P=B(b),n=B(O),m=e=>P.default.createElement(h,R(x({},e),{as:"th"})),h=r=>{var E=r,{coords:e,as:s}=E,a=I(E,["coords","as"]);const l=b.useRef(null),{rowIndex:q,colIndex:k,setTableValues:K}=D.useTable(),[d,N]=b.useState(!1),A=t=>{const o=c.getFocusableNodes(l.current,!0);if(o.length===0||o.length===1&&c.getFocusableNodesWithKeyboardNav(o).length===0)return;if(o.length>1&&!o.find(i=>i.tagName!=="BUTTON")){t.preventDefault();const i=o.findIndex(f=>f===document.activeElement);if(t.key===g.KeyboardKeys.RIGHT){const f=o[i+1];f&&(t.stopPropagation(),f.focus())}else if(t.key===g.KeyboardKeys.LEFT){const f=o[i-1];f&&(t.stopPropagation(),f.focus())}return}const u=t.key===g.KeyboardKeys.ENTER;if(u&&!d)N(!0);else if((t.key===g.KeyboardKeys.ESCAPE||u)&&d){if(u&&document.activeElement.tagName==="A")return;N(!1),l.current.focus()}else d&&t.stopPropagation()},p=q===e.row-1&&k===e.col-1;b.useLayoutEffect(()=>{const t=c.getFocusableNodes(l.current,!0);t.length===0||t.length===1&&c.getFocusableNodesWithKeyboardNav(t).length!==0||t.length>1&&Boolean(t.find(o=>o.tagName!=="BUTTON"))?(l.current.setAttribute("tabIndex",!d&&p?0:-1),t.forEach((o,u)=>{o.setAttribute("tabIndex",d?0:-1),d&&u===0&&o.focus()})):t.forEach(o=>{o.setAttribute("tabIndex",p?0:-1)})},[d,p]);const T=b.useCallback(()=>{const t=c.getFocusableNodes(l.current,!0);t.length>=1&&(c.getFocusableNodesWithKeyboardNav(t).length!==0||!t.find(o=>o.tagName!=="BUTTON"))&&N(!0),K({rowIndex:e.row-1,colIndex:e.col-1})},[e,K]);return b.useLayoutEffect(()=>{const t=l.current;return c.getFocusableNodes(t,!0).forEach(u=>{u.addEventListener("focus",T)}),()=>{c.getFocusableNodes(t,!0).forEach(i=>{i.removeEventListener("focus",T)})}},[T]),P.default.createElement(C.Box,x({role:"gridcell",as:s,ref:l,onKeyDown:A},a))};m.defaultProps={children:void 0,coords:{}};m.propTypes={"aria-colindex":n.default.number.isRequired,children:n.default.node,coords:n.default.shape({col:n.default.number,row:n.default.number})};h.defaultProps={as:"td",children:void 0,coords:{}};h.propTypes={"aria-colindex":n.default.number.isRequired,as:n.default.oneOf(["td","th"]),children:n.default.node,coords:n.default.shape({col:n.default.number,row:n.default.number})};exports.RawTd=h;exports.RawTh=m;
