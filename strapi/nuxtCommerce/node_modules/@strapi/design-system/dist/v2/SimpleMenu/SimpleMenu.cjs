"use strict";var Q=Object.defineProperty;var B=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var M=(e,n,o)=>n in e?Q(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,f=(e,n)=>{for(var o in n||(n={}))_.call(n,o)&&M(e,o,n[o]);if(B)for(var o of B(n))F.call(n,o)&&M(e,o,n[o]);return e};var R=(e,n)=>{var o={};for(var r in e)_.call(e,r)&&n.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&B)for(var r of B(e))n.indexOf(r)<0&&F.call(e,r)&&(o[r]=e[r]);return o};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const u=require("react"),X=require("prop-types"),Y=require("styled-components"),$=require("@radix-ui/react-use-callback-ref"),Z=require("@strapi/icons/CarretDown"),ee=require("../Link/Link.cjs"),S=require("../../Typography/Typography.cjs"),C=require("../../Box/Box.cjs"),te=require("../../Flex/Flex.cjs"),A=require("../../Button/Button.cjs"),ne=require("../../BaseLink/BaseLink.cjs"),N=require("../../Popover/Popover.cjs"),D=require("./utils.cjs"),oe=require("../../helpers/useId.cjs"),c=require("../../helpers/keyboardKeys.cjs"),K=e=>e&&typeof e=="object"&&"default"in e?e:{default:e},s=K(u),t=K(X),g=K(Y),ae=K(Z),se=g.default.button`
  border: none;
  padding: 0;
  background: transparent;
  cursor: pointer;
  ${D.getOptionStyle}
`,re=g.default(ne.BaseLink)`
  text-decoration: none;
  ${D.getOptionStyle}
`,le=g.default(ee.Link)`
  &:focus-visible {
    /* Removes Link focus-visible after properties and reset to global outline */
    outline: 2px solid ${({theme:e})=>e.colors.primary600};
    outline-offset: 2px;
    &:after {
      content: none;
    }
  }
  /* Removes Link svg color */
  svg path {
    fill: currentColor;
  }
  ${D.getOptionStyle}
`,ue=g.default.span`
  display: flex;
  align-items: center;
  svg {
    height: 4px;
    width: 6px;
  }
`,ie=g.default(A.Button)`
  padding: ${({theme:e})=>`${e.spaces[1]} ${e.spaces[3]}`};
`,I=L=>{var b=L,{as:e,children:n,onClick:o,isFocused:r,isLink:v,isExternal:P}=b,T=R(b,["as","children","onClick","isFocused","isLink","isExternal"]);const h=u.useRef();u.useEffect(()=>{r&&h.current&&h.current.focus()},[r]);const d=f({tabIndex:r?0:-1,ref:h,role:"menuitem"},T),i=p=>{(p.key===c.KeyboardKeys.SPACE||p.key===c.KeyboardKeys.ENTER)&&o()};return v?s.default.createElement(re,f({as:e},d),s.default.createElement(C.Box,{padding:2},s.default.createElement(S.Typography,null,n))):P?s.default.createElement(le,f({isExternal:!0},d),s.default.createElement(C.Box,{padding:2},s.default.createElement(S.Typography,null,n))):s.default.createElement(se,f({onKeyDown:i,onMouseDown:o,type:"button"},d),s.default.createElement(C.Box,{padding:2},s.default.createElement(S.Typography,null,n)))};I.defaultProps={as:void 0,onClick(){},isExternal:!1,isFocused:!1,isLink:!1};I.propTypes={as:t.default.elementType,children:t.default.node.isRequired,isExternal:t.default.bool,isFocused:t.default.bool,isLink:t.default.bool,onClick:t.default.func};const k=h=>{var d=h,{label:e,children:n,id:o,as:r,onOpen:v=()=>{},onClose:P=()=>{},size:T,popoverPlacement:L}=d,b=R(d,["label","children","id","as","onOpen","onClose","size","popoverPlacement"]);const i=u.useRef(),p=oe.useId("simplemenu",o),y=u.useRef(!1),[m,E]=u.useState(!1),[q,O]=u.useState(0),x=u.Children.toArray(n),V=T==="S"?ie:A.Button,W=r||V;u.useEffect(()=>{if(["string","number"].includes(typeof e)){const a=x.findIndex(l=>l.props.children===e);a!==-1&&O(a)}},[e]);const j=$.useCallbackRef(v),w=$.useCallbackRef(P);u.useEffect(()=>{y!=null&&y.current?m?j():w():y.current=!0},[y,m,j,w]),u.useEffect(()=>{s.default.isValidElement(e)&&q===-1&&i.current.focus()},[e,q]);const z=a=>{m&&(a.key===c.KeyboardKeys.ESCAPE&&(a.stopPropagation(),E(!1),i.current.focus()),a.key===c.KeyboardKeys.DOWN&&O(l=>l===x.length-1?0:l+1),a.key===c.KeyboardKeys.UP&&O(l=>l===0?x.length-1:l-1))},U=a=>{(a.key===c.KeyboardKeys.ENTER||a.key===c.KeyboardKeys.SPACE)&&E(l=>!l)},G=a=>{a.preventDefault(),a.currentTarget.contains(a.relatedTarget)||E(!1)},H=a=>{a.preventDefault(),E(l=>!l)},J=x.map((a,l)=>s.default.createElement(te.Flex,{as:"li",key:l,justifyContent:"center",role:"menuitem"},u.cloneElement(a,{onClick(){a.props.onClick(),E(!1),i.current.focus()},isFocused:q===l})));return s.default.createElement("div",{onKeyDown:z},s.default.createElement(W,f({label:s.default.isValidElement(e)?null:e,"aria-haspopup":!0,"aria-expanded":m,"aria-controls":p,onKeyDown:U,onMouseDown:H,ref:i,type:"button",variant:"ghost",endIcon:s.default.createElement(ue,null,s.default.createElement(ae.default,{"aria-hidden":!0}))},b),e),m&&s.default.createElement(N.Popover,{onBlur:G,placement:L,source:i,spacing:4},s.default.createElement(C.Box,{role:"menu",as:"ul",padding:1,id:p},J)))};k.defaultProps={as:void 0};k.displayName="SimpleMenu";k.defaultProps={id:void 0,onClose(){},onOpen(){},popoverPlacement:"bottom-start",size:"M"};k.propTypes={as:t.default.any,children:t.default.oneOfType([t.default.arrayOf(t.default.node),t.default.node]).isRequired,id:t.default.string,label:t.default.oneOfType([t.default.string,t.default.number,t.default.element]).isRequired,onClose:t.default.func,onOpen:t.default.func,popoverPlacement:t.default.oneOf(N.POPOVER_PLACEMENTS),size:t.default.oneOf(["S","M"])};exports.MenuItem=I;exports.SimpleMenu=k;
