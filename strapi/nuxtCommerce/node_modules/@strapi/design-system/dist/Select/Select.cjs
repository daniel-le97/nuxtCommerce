"use strict";var ie=Object.defineProperty;var j=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var N=(l,a,o)=>a in l?ie(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,Q=(l,a)=>{for(var o in a||(a={}))J.call(a,o)&&N(l,o,a[o]);if(j)for(var o of j(a))K.call(a,o)&&N(l,o,a[o]);return l};var U=(l,a)=>{var o={};for(var s in l)J.call(l,s)&&a.indexOf(s)<0&&(o[s]=l[s]);if(l!=null&&j)for(var s of j(l))a.indexOf(s)<0&&K.call(l,s)&&(o[s]=l[s]);return o};Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const y=require("react"),ce=require("prop-types"),de=require("@strapi/icons/CarretDown"),ue=require("@strapi/icons/Cross"),fe=require("styled-components"),pe=require("../themes/sizes.cjs"),ye=require("./SelectButton.cjs"),he=require("../Field/Field.cjs"),me=require("../Field/FieldLabel.cjs");require("../Field/FieldInput.cjs");const Ee=require("../Field/FieldHint.cjs"),ge=require("../Field/FieldError.cjs");require("../Field/FieldContext.cjs");require("../Field/FieldAction.cjs");const be=require("../Popover/Popover.cjs"),qe=require("../Stack/Stack.cjs"),V=require("../Typography/Typography.cjs"),_=require("../Flex/Flex.cjs"),X=require("../Box/Box.cjs"),Fe=require("../helpers/useId.cjs"),Se=require("./SelectList.cjs"),O=require("./components.cjs"),je=require("./hooks/useButtonRef.cjs"),Y=require("../VisuallyHidden/VisuallyHidden.cjs"),Be=require("./constants.cjs"),Z=require("../helpers/escapeSelector.cjs"),Te=require("./SelectTags.cjs"),m=l=>l&&typeof l=="object"&&"default"in l?l:{default:l},r=m(y),e=m(ce),xe=m(de),ve=m(ue),Ce=m(fe),Ie=Ce.default(_.Flex)`
  width: 100%;
`,R=Oe=>{var w=Oe,{label:l,labelAction:a,id:o,children:s,customizeContent:E,placeholder:B,onChange:T,value:n,hint:x,error:g,disabled:u,clearLabel:L,onClear:D,onReachEnd:ee,multi:c,required:te,selectButtonTitle:le,size:re,startIcon:$,withTags:b}=w,ne=U(w,["label","labelAction","id","children","customizeContent","placeholder","onChange","value","hint","error","disabled","clearLabel","onClear","onReachEnd","multi","required","selectButtonTitle","size","startIcon","withTags"]);const i=Fe.useId("select",o),[q,F]=y.useState(void 0),k=je.useButtonRef(q),H=y.useRef(null),M=`${i}-label`,S=`${i}-content`,P=typeof g=="string";let v;if(P?v=`${i}-error`:x&&(v=`${i}-hint`),b&&!c)throw new Error('The "withTags" props can only be used when the "multi" prop is present');const oe=()=>{F(void 0)},ae=()=>{u||(D(),k.current.focus())},A=t=>{t.preventDefault(),!u&&(t.nativeEvent.which===3||t.nativeEvent.button===2||F(Be.DownState.Mouse))},C=(t,d=!0)=>{c?T(n.includes(t)?n.filter(f=>f!==t):[...n,t]):(T(t),d&&F(void 0))},z=t=>{T(n.includes(t[0])?n.filter((d,f,h)=>h.indexOf(d)<0,t):[...n,...t])};let I,G=[];const W=(t,d)=>{const f=`${i}-option-${t.props.value}`,h=c?n.includes(t.props.value):t.props.value===n;return h&&(b?G.push({label:t.props.children,value:t.props.value}):I=t.props.children),y.cloneElement(t,{id:Z.escapeSelector(f),onClick:()=>C(t.props.value),selected:h,multi:c,isChild:d})},se=y.Children.toArray(s).map(t=>{if(t.type.displayName==="OptGroup"){const d=`${i}-option-${t.props.label}`,f=t.props.children.every(p=>n.includes(p.props.value)),h=!f&&t.props.children.some(p=>n.includes(p.props.value));return y.cloneElement(t,{id:Z.escapeSelector(d),onClick:()=>z(t.props.children.map(p=>p.props.value)),selected:f,indeterminate:h,multi:c,children:y.Children.toArray(t.props.children).map(p=>W(p,!0)),value:t.props.label})}return W(t)});return r.default.createElement(he.Field,{hint:x,error:g,id:i,required:te},r.default.createElement(qe.Stack,{spacing:l||x||P?1:0},l&&r.default.createElement(me.FieldLabel,{as:"span",action:a},l),r.default.createElement(O.SelectButtonWrapper,{size:re,hasError:Boolean(g),disabled:u,ref:H},r.default.createElement(ye.SelectButton,Q({ref:k,labelledBy:`${M} ${S}`,"aria-describedby":v,expanded:Boolean(q),onTrigger:F,id:i,hasError:Boolean(g),disabled:u,onMouseDown:A},ne)),r.default.createElement(Ie,{justifyContent:"space-between"},r.default.createElement(_.Flex,null,$&&r.default.createElement(X.Box,{paddingLeft:3,"aria-hidden":!0},$),b&&r.default.createElement(Te.SelectTags,{tags:G,onRemoveTag:C,disabled:u}),r.default.createElement(X.Box,{paddingLeft:4,paddingRight:4},b?r.default.createElement(r.default.Fragment,null,!n||n.length===0?r.default.createElement(V.Typography,{ellipsis:!0,id:S,textColor:"neutral600"},B):null,r.default.createElement(Y.VisuallyHidden,{as:"span",id:S},E?E(n):I||B,n.join(", "))):r.default.createElement(V.Typography,{ellipsis:!0,id:S,textColor:n?"neutral800":"neutral600"},E?E(n):I||B,c&&r.default.createElement(Y.VisuallyHidden,{as:"span"},n.join(", "))))),r.default.createElement(_.Flex,null,(c&&n&&n.length||!c&&n)&&D&&r.default.createElement(O.IconBox,{as:"button",type:"button",onClick:ae,"aria-label":L,"aria-disabled":u,title:L},r.default.createElement(ve.default,null)),r.default.createElement(O.CaretBox,{paddingLeft:3,"aria-hidden":!0,as:"button",type:"button",onMouseDown:A,tabIndex:-1,disabled:u,title:le},r.default.createElement(xe.default,null))))),r.default.createElement(Ee.FieldHint,null),r.default.createElement(ge.FieldError,null)),q&&r.default.createElement(be.Popover,{source:H,spacing:4,fullWidth:!0,intersectionId:`select-list-intersection-${i}`,onReachEnd:ee},r.default.createElement(Se.SelectList,{selectId:i,labelledBy:l?M:void 0,onEscape:oe,expanded:q,onSelectItem:(t,d)=>d?z(t):C(t,!1),multi:c},se)))};R.defaultProps={"aria-label":void 0,children:[],clearLabel:"Clear",customizeContent:void 0,disabled:!1,id:void 0,label:void 0,labelAction:void 0,multi:!1,onChange(){},onClear:void 0,onReachEnd:void 0,value:void 0,hint:void 0,error:void 0,placeholder:"Select...",required:!1,selectButtonTitle:"Carret Down Button",size:"M",startIcon:void 0,withTags:!1};R.propTypes={"aria-label":e.default.string,children:e.default.oneOfType([e.default.arrayOf(e.default.node),e.default.node]),clearLabel:e.default.string,customizeContent:e.default.func,disabled:e.default.bool,error:e.default.oneOfType([e.default.string,e.default.bool]),hint:e.default.oneOfType([e.default.string,e.default.node,e.default.arrayOf(e.default.node)]),id:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.string,labelAction:e.default.element,multi:e.default.bool,onChange:e.default.func,onClear:e.default.func,onReachEnd:e.default.func,placeholder:e.default.string,required:e.default.bool,selectButtonTitle:e.default.string,size:e.default.oneOf(Object.keys(pe.sizes.input)),startIcon:e.default.element,value:e.default.oneOfType([e.default.arrayOf(e.default.oneOfType([e.default.string,e.default.number])),e.default.string,e.default.number]),withTags:e.default.bool};exports.Select=R;
